<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<title>Cu·ªôc ƒëua doanh s·ªë</title>

<style>
body {
  margin: 0;
  background: #0f172a;
  color: #fff;
  font-family: Arial, Helvetica, sans-serif;
}

h1 {
  text-align: center;
  padding: 20px 0;
  margin: 0;
  font-size: 36px;
  color: #facc15;
}

#container {
  display: flex;
  align-items: flex-end;
  justify-content: space-around;
  height: 70vh;
  padding: 40px;
  gap: 30px;
}

/* m·ªói c·ªôt */
.column {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 140px;
}

/* icon */
.icon {
  font-size: 48px;
  margin-bottom: 10px;
}

/* c·ªôt doanh s·ªë */
.bar {
  width: 100%;
  background: linear-gradient(180deg, #22c55e, #16a34a);
  border-radius: 14px 14px 0 0;
  display: flex;
  align-items: flex-end;
  justify-content: center;
  transition: height 1s ease;
  box-shadow: 0 0 12px rgba(34,197,94,0.7);
}

/* s·ªë ti·ªÅn */
.sales {
  font-size: 22px;
  font-weight: 800;
  margin-bottom: 10px;
  color: #facc15;
  text-shadow: 0 0 6px rgba(250,204,21,0.7);
}

/* t√™n */
.name {
  margin-top: 12px;
  font-size: 20px;
  font-weight: bold;
  text-align: center;
}

/* top 1 */
.column.leader .bar {
  background: linear-gradient(180deg, #facc15, #eab308);
  box-shadow: 0 0 20px rgba(250,204,21,0.9);
}
</style>
</head>

<body>
<h1>üèÜ CU·ªòC ƒêUA DOANH S·ªê TH√ÅNG</h1>

<div id="container"></div>

<script>
/* ====== C·∫§U H√åNH ====== */
const TARGET = 3000000000; // 3 T·ª∂
const SHEET_ID = "1ZFde_VPigMDlqlsM2aVKudr36yW6KmgYSJ_kovAeWNE";
const SHEET_NAME = "Sheet1";
const REFRESH_TIME = 30000; // 30 gi√¢y

/* ====== LOAD DATA ====== */
async function loadData() {
  const url = `https://opensheet.elk.sh/${SHEET_ID}/${SHEET_NAME}`;
  const res = await fetch(url);
  const rows = await res.json();

  const data = rows.map(r => ({
    name: r.name,
    icon: r.icon || "üíº",
    sales: Number(r.sales.toString().replace(/[^\d]/g, ""))
  }));

  render(data);
}

/* ====== HI·ªÇN TH·ªä ====== */
function render(data) {
  // s·∫Øp x·∫øp gi·∫£m d·∫ßn
  data.sort((a, b) => b.sales - a.sales);

  const container = document.getElementById("container");
  container.innerHTML = "";

  data.forEach((item, index) => {
    const percent = Math.min(item.sales / TARGET * 100, 100);

    const col = document.createElement("div");
    col.className = "column";
    if (index === 0) col.classList.add("leader");

    const icon = document.createElement("div");
    icon.className = "icon";
    icon.textContent = item.icon;

    const bar = document.createElement("div");
    bar.className = "bar";
    bar.style.height = percent + "%";

    const sales = document.createElement("div");
    sales.className = "sales";
    sales.textContent = formatMoney(item.sales);

    bar.appendChild(sales);

    const name = document.createElement("div");
    name.className = "name";
    name.textContent = item.name;

    col.appendChild(icon);
    col.appendChild(bar);
    col.appendChild(name);

    container.appendChild(col);
  });
}

/* ====== FORMAT TI·ªÄN ====== */
function formatMoney(n) {
  return n.toLocaleString("vi-VN") + " ‚Ç´";
}

/* ====== CH·∫†Y ====== */
loadData();
setInterval(loadData, REFRESH_TIME);
</script>

</body>
</html>
