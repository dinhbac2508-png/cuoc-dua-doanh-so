<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Cu·ªôc ƒêua Doanh S·ªë</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: #0f172a;
    color: white;
    margin: 0;
    padding: 20px;
  }

  h1 {
    text-align: center;
    margin-bottom: 5px;
  }

  .target {
    text-align: center;
    color: #facc15;
    font-size: 20px;
    margin-bottom: 25px;
  }

  .race {
    display: flex;
    flex-direction: column;
    gap: 18px;
  }

  .lane {
    position: relative;
    background: #1e293b;
    border-radius: 14px;
    padding: 14px;
    height: 90px;
    overflow: hidden;
  }

  .info {
    display: flex;
    align-items: center;
    gap: 15px;
    z-index: 2;
    position: relative;
  }

  .name {
  min-width: 230px;
  font-size: 25px;
  font-weight: bold;
}


  .sales {
  font-size: 26px;        /* TO */
  font-weight: 800;      /* ƒê·∫¨M */
  color: #facc15;        /* V√ÄNG N·ªîI */
  text-shadow: 0 0 6px rgba(250,204,21,0.6);
}


  .track {
  position: absolute;
  left: 220px;
  right: 110px;
  top: 50%;
  height: 14px;              /* TO H∆†N */
  background: linear-gradient(
    90deg,
    #475569,
    #64748b,
    #475569
  );
  transform: translateY(-50%);
  border-radius: 8px;
  box-shadow: inset 0 0 6px rgba(0,0,0,0.6);
}

  .finish-line {
    position: absolute;
    right: 40px;
    top: 12px;
    bottom: 12px;
    width: 6px;
    background: repeating-linear-gradient(
      white 0 10px,
      black 10px 20px
    );
  }

  .runner {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  font-size: 56px;        /* ICON TO H∆†N */
  transition: left 1s ease;
  z-index: 3;
}

  /* TOP 1 */
  .top1 {
    border: 4px solid gold;
    background: linear-gradient(135deg, #fff1a8, #ffd700);
    animation: glow 1s infinite alternate;
  }

  @keyframes glow {
    from { box-shadow: 0 0 10px gold; }
    to { box-shadow: 0 0 30px gold; }
  }

  /* WINNER */
  .finish {
    position: absolute;
    right: 110px;
    top: 10px;
    font-size: 22px;
    font-weight: bold;
    color: red;
  }

  /* FIREWORK */
  .firework {
    position: fixed;
    top: 50%;
    left: 50%;
    width: 10px;
    height: 10px;
    animation: explode 1s linear infinite;
  }

  @keyframes explode {
    0% { box-shadow: 0 0 gold; }
    100% {
      box-shadow:
        0 -200px gold,
        0 200px red,
        200px 0 blue,
        -200px 0 green,
        140px 140px pink,
        -140px -140px orange;
    }
  }
</style>
</head>

<body>

<h1>üèÅ CU·ªòC ƒêUA DOANH S·ªê TH√ÅNG</h1>
<div class="target">üéØ M·ª•c ti√™u: 3.000.000.000 VNƒê</div>

<div class="race" id="race"></div>

<audio id="winSound">
  <source src="https://actions.google.com/sounds/v1/alarms/celebration.ogg" type="audio/ogg">
</audio>

<script>
const TARGET = 3000000000;
const SHEET_URL = "https://opensheet.elk.sh/1ZFde_VPigMDlqlsM2aVKudr36yW6KmgYSJ_kovAeWNE/DATA";

async function loadData() {
  const res = await fetch(SHEET_URL);
  const data = await res.json();

  const race = document.getElementById("race");
  race.innerHTML = "";

  const maxSales = Math.max(...data.map(d => Number(d["Doanh s·ªë hi·ªán t·∫°i"])));
  let hasWinner = false;

  data.forEach(d => {
    const sales = Number(d["Doanh s·ªë hi·ªán t·∫°i"]);
    const percent = Math.min((sales / TARGET) * 100, 100);

    const lane = document.createElement("div");
    lane.className = "lane";

    if (sales === maxSales) {
      lane.classList.add("top1");
    }

    if (sales >= TARGET) {
      hasWinner = true;
    }

    const startX = 200;
    const endX = window.innerWidth - 160;
    const posX = startX + (endX - startX) * (percent / 100);

    lane.innerHTML = `
      <div class="info">
        <div class="name">${d.T√™n}</div>
        <div class="sales">${sales.toLocaleString()} VNƒê</div>
      </div>

      <div class="track"></div>
      <div class="finish-line"></div>

      <div class="runner" style="left:${posX}px">
        ${d.icon}
      </div>

      ${sales >= TARGET ? '<div class="finish">üèÅ V·ªÄ ƒê√çCH</div>' : ''}
    `;

    race.appendChild(lane);
  });

  if (hasWinner && !localStorage.getItem("fired")) {
    showFirework();
    localStorage.setItem("fired", "yes");
  }
}

function showFirework() {
  const fw = document.createElement("div");
  fw.className = "firework";
  document.body.appendChild(fw);
  document.getElementById("winSound").play();
  setTimeout(() => fw.remove(), 5000);
}

loadData();
</script>

</body>
</html>
