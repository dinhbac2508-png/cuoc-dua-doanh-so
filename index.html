<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Cu·ªôc ƒëua doanh s·ªë</title>

<style>
body {
  margin: 0;
  background: #0f172a;
  color: #fff;
  font-family: Arial, Helvetica, sans-serif;
}

h1 {
  text-align: center;
  margin: 20px 0;
  font-size: 36px;
  color: #facc15;
}

#container {
  display: flex;
  align-items: flex-end;
  justify-content: space-around;
  height: 70vh;
  padding: 40px;
  gap: 30px;
}

/* m·ªói c·ªôt */
.column {
  width: 140px;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* icon */
.icon {
  font-size: 48px;
  margin-bottom: 10px;
}

/* v√πng ch·ª©a c·ªôt */
.bar-wrapper {
  height: 100%;
  width: 100%;
  display: flex;
  align-items: flex-end;
}

/* c·ªôt doanh s·ªë */
.bar {
  width: 100%;
  background: linear-gradient(180deg, #22c55e, #16a34a);
  border-radius: 14px 14px 0 0;
  display: flex;
  align-items: flex-end;
  justify-content: center;
  transition: height 1s ease;
  box-shadow: 0 0 12px rgba(34,197,94,0.7);
  position: relative;
}

/* top 1 */
.column.leader .bar {
  background: linear-gradient(180deg, #facc15, #eab308);
  box-shadow: 0 0 20px rgba(250,204,21,0.9);
}

/* % */
.percent {
  position: absolute;
  top: -32px;
  font-size: 20px;
  font-weight: 800;
  color: #facc15;
  text-shadow: 0 0 6px rgba(250,204,21,0.7);
}

/* ti·ªÅn */
.sales {
  font-size: 22px;
  font-weight: 800;
  color: #fff;
  margin-bottom: 10px;
  text-shadow: 0 0 6px rgba(0,0,0,0.6);
}

/* t√™n */
.name {
  margin-top: 12px;
  font-size: 20px;
  font-weight: bold;
  text-align: center;
}
</style>
</head>

<body>

<h1>üèÜ CU·ªòC ƒêUA DOANH S·ªê TH√ÅNG</h1>
<div id="container"></div>

<script>
/* ===== C·∫§U H√åNH ===== */
const TARGET = 3000000000; // 3 t·ª∑
const SHEET_ID = "1ZFde_VPigMDlqlsM2aVKudr36yW6KmgYSJ_kovAeWNE";
const SHEET_NAME = "Sheet1";
const REFRESH_TIME = 30000;

/* ===== LOAD DATA ===== */
async function loadData() {
  try {
    const url = `https://opensheet.elk.sh/${SHEET_ID}/${SHEET_NAME}`;
    const res = await fetch(url);
    const rows = await res.json();

    const data = rows.map(r => ({
      name: r.name,
      icon: r.icon || "üíº",
      sales: Number(r.sales.toString().replace(/[^\d]/g, ""))
    }));

    render(data);
  } catch (e) {
    document.body.innerHTML = "<h1 style='text-align:center'>‚ùå Kh√¥ng t·∫£i ƒë∆∞·ª£c d·ªØ li·ªáu Google Sheet</h1>";
    console.error(e);
  }
}

/* ===== RENDER ===== */
function render(data) {
  data.sort((a, b) => b.sales - a.sales);

  const container = document.getElementById("container");
  container.innerHTML = "";

  data.forEach((item, index) => {
    const percent = Math.min(item.sales / TARGET * 100, 100);

    const col = document.createElement("div");
    col.className = "column";
    if (index === 0) col.classList.add("leader");

    const icon = document.createElement("div");
    icon.className = "icon";
    icon.textContent = item.icon;

    const barWrapper = document.createElement("div");
    barWrapper.className = "bar-wrapper";

    const bar = document.createElement("div");
    bar.className = "bar";
    bar.style.height = percent + "%";

    const percentText = document.createElement("div");
    percentText.className = "percent";
    percentText.textContent = Math.round(percent) + "%";

    const sales = document.createElement("div");
    sales.className = "sales";
    sales.textContent = item.sales.toLocaleString("vi-VN") + " ‚Ç´";

    const name = document.createElement("div");
    name.className = "name";
    name.textContent = item.name;

    bar.appendChild(percentText);
    bar.appendChild(sales);
    barWrapper.appendChild(bar);

    col.appendChild(icon);
    col.appendChild(barWrapper);
    col.appendChild(name);

    container.appendChild(col);
  });
}

/* ===== CH·∫†Y ===== */
loadData();
setInterval(loadData, REFRESH_TIME);
</script>

</body>
</html>
